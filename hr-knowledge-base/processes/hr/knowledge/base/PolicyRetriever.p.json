{
  "$schema" : "https://json-schema.axonivy.com/14.0-dev/project/process.json",
  "id" : "19BE9FB6D1A78C01",
  "kind" : "CALLABLE_SUB",
  "config" : {
    "data" : "hr.knowledge.base.PolicyRetrieverData"
  },
  "elements" : [ {
      "id" : "f0",
      "type" : "CallSubStart",
      "name" : "retrievePolicies(String)",
      "config" : {
        "signature" : "retrievePolicies",
        "input" : {
          "params" : [
            { "name" : "query", "type" : "String", "desc" : "The HR policy question or query from the user" }
          ],
          "map" : {
            "out.query" : "param.query"
          }
        },
        "result" : {
          "params" : [
            { "name" : "formattedPolicies", "type" : "String", "desc" : "Formatted HR policy content relevant to the query" }
          ],
          "map" : {
            "result.formattedPolicies" : "in.policyContent"
          }
        }
      },
      "visual" : {
        "at" : { "x" : 120, "y" : 72 }
      },
      "connect" : [
        { "id" : "f2", "to" : "f3" }
      ]
    }, {
      "id" : "f1",
      "type" : "CallSubEnd",
      "visual" : {
        "at" : { "x" : 392, "y" : 72 }
      }
    }, {
      "id" : "f3",
      "type" : "ProgramInterface",
      "name" : "HR Policy Agent",
      "config" : {
        "javaClass" : "com.axonivy.utils.smart.workflow.AgenticProcessCall",
        "userConfig" : {
          "model" : "\"gpt-4o\"",
          "system" : "AI Agent specialized in providing HR policy information.\r\nAnswers employee questions about company policies by retrieving the most relevant policy content.\r\nInstructions:\r\n1. Analyze the user's query to identify which policy category is most relevant.\r\n2. Use the appropriate policy retrieval tool to get the policy content.\r\n3. Return the formatted policy content that answers the user's question.\r\n4 If multiple policy categories are relevant, retrieve all of them",
          "resultType" : "",
          "tools" : "[\"getBenefitPolicies\",\"getGeneralPolicies\",\"getLeavePolicies\"]",
          "resultMapping" : "in.policyContent",
          "query" : "<%= in.query %>"
        }
      },
      "visual" : {
        "at" : { "x" : 264, "y" : 72 }
      },
      "connect" : [
        { "id" : "f4", "to" : "f1", "color" : "default" }
      ]
    }, {
      "id" : "f5",
      "type" : "CallSubStart",
      "name" : "getBenefitPolicies(String)",
      "config" : {
        "signature" : "getBenefitPolicies",
        "input" : {
          "params" : [
            { "name" : "query", "type" : "String", "desc" : "Query to get policies" }
          ],
          "map" : {
            "out.query" : "param.query"
          }
        },
        "result" : {
          "params" : [
            { "name" : "policyContent", "type" : "String", "desc" : "Formatterd benefit policies" }
          ],
          "map" : {
            "result.policyContent" : "in.policyContent"
          }
        }
      },
      "tags" : [
        "tool"
      ],
      "visual" : {
        "at" : { "x" : 120, "y" : 296 },
        "description" : "Use this tool when the query asking about company benefit policies"
      },
      "connect" : [
        { "id" : "f19", "to" : "f15" }
      ]
    }, {
      "id" : "f9",
      "type" : "CallSubEnd",
      "visual" : {
        "at" : { "x" : 392, "y" : 296 }
      }
    }, {
      "id" : "f15",
      "type" : "Script",
      "name" : "get benefit policies",
      "config" : {
        "output" : {
          "code" : "in.policyContent = ivy.cms.co(\"/Policies/Benefits\");"
        }
      },
      "visual" : {
        "at" : { "x" : 256, "y" : 296 }
      },
      "connect" : [
        { "id" : "f20", "to" : "f9" }
      ]
    }, {
      "id" : "f31",
      "type" : "CallSubStart",
      "name" : "getGeneralPolicies(String)",
      "config" : {
        "signature" : "getGeneralPolicies",
        "input" : {
          "params" : [
            { "name" : "query", "type" : "String", "desc" : "Query to get policies" }
          ],
          "map" : {
            "out.query" : "param.query"
          }
        },
        "result" : {
          "params" : [
            { "name" : "policyContent", "type" : "String", "desc" : "Formatted general HR policies" }
          ],
          "map" : {
            "result.policyContent" : "in.policyContent"
          }
        }
      },
      "tags" : [
        "tool"
      ],
      "visual" : {
        "at" : { "x" : 512, "y" : 296 },
        "description" : "Use this tool when the query is about general HR policies, code of conduct, dress code, or workplace rules"
      },
      "connect" : [
        { "id" : "f32", "to" : "f33" }
      ]
    }, {
      "id" : "f33",
      "type" : "Script",
      "name" : "get general policies",
      "config" : {
        "output" : {
          "code" : "in.policyContent = ivy.cms.co(\"/Policies/General\");"
        }
      },
      "visual" : {
        "at" : { "x" : 648, "y" : 296 }
      },
      "connect" : [
        { "id" : "f34", "to" : "f35" }
      ]
    }, {
      "id" : "f35",
      "type" : "CallSubEnd",
      "visual" : {
        "at" : { "x" : 784, "y" : 296 }
      }
    }, {
      "id" : "f36",
      "type" : "CallSubStart",
      "name" : "getLeavePolicies(String)",
      "config" : {
        "signature" : "getLeavePolicies",
        "input" : {
          "params" : [
            { "name" : "query", "type" : "String", "desc" : "Query to get policies" }
          ],
          "map" : {
            "out.query" : "param.query"
          }
        },
        "result" : {
          "params" : [
            { "name" : "policyContent", "type" : "String", "desc" : "Formatted leave policies" }
          ],
          "map" : {
            "result.policyContent" : "in.policyContent"
          }
        }
      },
      "tags" : [
        "tool"
      ],
      "visual" : {
        "at" : { "x" : 120, "y" : 408 },
        "description" : "Use this tool when the query is about leave of absence, sick leave, FMLA, parental leave, or bereavement"
      },
      "connect" : [
        { "id" : "f37", "to" : "f38" }
      ]
    }, {
      "id" : "f38",
      "type" : "Script",
      "name" : "get leave policies",
      "config" : {
        "output" : {
          "code" : "in.policyContent = ivy.cms.co(\"/Policies/Leave\");"
        }
      },
      "visual" : {
        "at" : { "x" : 256, "y" : 408 }
      },
      "connect" : [
        { "id" : "f39", "to" : "f40" }
      ]
    }, {
      "id" : "f40",
      "type" : "CallSubEnd",
      "visual" : {
        "at" : { "x" : 392, "y" : 408 }
      }
    }, {
      "id" : "f41",
      "type" : "ProcessAnnotation",
      "name" : [
        "HR Policy Agent",
        "",
        "This agent in charge of analyzing the user message then reply with relevant policies ",
        "",
        "Tools:",
        "- getBenefiPolicies: Get policies related to employee's benefits",
        "- getLeavePolicies: Get policies related to leave request",
        "- getGeneralPolicies: General HR policies that all employees must follow"
      ],
      "visual" : {
        "at" : { "x" : 704, "y" : 96 },
        "size" : { "width" : 518, "height" : 190 }
      }
    } ],
  "layout" : {
    "lanes" : [ {
        "name" : "Tools of HR Policy Agent",
        "offset" : 232,
        "size" : 248
      } ]
  }
}